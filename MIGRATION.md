# Информация о миграциях

## Текущее состояние

Схема базы данных была применена через `prisma db push --force-reset`.

Миграция создана вручную в папке `prisma/migrations/20260107204750_init_full_schema/`.

## Применение миграции

Для продакшн-окружения используйте:

```powershell
npx prisma migrate deploy
```

Эта команда применит все неприменённые миграции к базе данных.

## Создание новых миграций

Для создания новых миграций в интерактивном режиме:

```powershell
npx prisma migrate dev --name название_миграции
```

## Текущие модели

- **User** - пользователи системы
- **Note** - заметки пользователей
- **Film** - промты (публичные/приватные)
- **Category** - категории промтов
- **Tag** - теги для промтов
- **FilmTag** - связь многие-ко-многим между Film и Tag
- **Vote** - голоса пользователей за публичные промты

## Связи

- User → Note (один-ко-многим)
- User → Film (один-ко-многим)
- User → Vote (один-ко-многим)
- Category → Film (один-ко-многим)
- Film ↔ Tag (многие-ко-многим через FilmTag)
- Film → Vote (один-ко-многим)

## Индексы и ограничения

- `UNIQUE(userId, promptId)` для Vote
- Индексы на Film: `[ownerId, updatedAt]`, `[visibility, createdAt]`
- Индексы на Vote: `[promptId]`, `[userId]`
- Все связи с `onDelete: Cascade`


