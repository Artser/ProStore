# –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ª–∞–π–∫–æ–≤ –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —Ñ–∏–ª—å–º–æ–≤

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö (Prisma)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –º–æ–¥–µ–ª—å `Like` –≤ `prisma/schema.prisma`
- ‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å `@@unique([userId, filmId])` - –∑–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- ‚úÖ –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: `@@index([filmId])`, `@@index([userId])`
- ‚úÖ –°–≤—è–∑–∏: `Like -> User`, `Like -> Film` —Å `onDelete: Cascade`

### 2. API Route
- ‚úÖ `POST /api/films/[id]/like` - toggle –ª–∞–π–∫–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (401 –µ—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—É–±–ª–∏—á–Ω–æ—Å—Ç–∏ —Ñ–∏–ª—å–º–∞ (403 –µ—Å–ª–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∏–ª—å–º–∞ (404 –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω)
- ‚úÖ –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å: –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å –º–µ–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ (toggle)
- ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `{ liked: boolean, likesCount: number }`
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (race conditions, —Å–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏)

### 3. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—É–±–ª–∏—á–Ω—ã—Ö —Ñ–∏–ª—å–º–æ–≤
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ `likesCount` —á–µ—Ä–µ–∑ `_count.likes`
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ `likedByMe` –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ (`?sort=popular`) - –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ª–∞–π–∫–æ–≤
- ‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ (`?sort=recent`) - –ø–æ –¥–∞—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- ‚úÖ UI –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ (–∫–Ω–æ–ø–∫–∏ "–ü–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏" / "–ü–æ –¥–∞—Ç–µ")

### 4. UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- ‚úÖ `LikeButton` - –∫–Ω–æ–ø–∫–∞ –ª–∞–π–∫–∞ —Å –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
  - –ò–∫–æ–Ω–∫–∞ `ThumbsUp` –∏–∑ `lucide-react`
  - –°—á–µ—Ç—á–∏–∫ –ª–∞–π–∫–æ–≤
  - –í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è (–ª–∞–π–∫–Ω—É—Ç/–Ω–µ –ª–∞–π–∫–Ω—É—Ç)
  - Disabled —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–æ –≤—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–∞
  - –û—Ç–∫–∞—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ (rollback)
  - –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/login` –ø—Ä–∏ 401
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ `FilmCard` - –∫–Ω–æ–ø–∫–∞ –ª–∞–π–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —Ñ–∏–ª—å–º–æ–≤
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/dashboard/public`

## üìã –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

```powershell
# 1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã –∫ –ë–î
npx prisma db push

# 2. –ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Prisma Client (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
npx prisma generate

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç
npm run dev
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏:

1. **–ë–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ `/dashboard/public` –±–µ–∑ –ª–æ–≥–∏–Ω–∞
   - –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/login`

2. **–° –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π:**
   - –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É
   - –û—Ç–∫—Ä–æ–π—Ç–µ `/dashboard/public`
   - –î–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –ø—É–±–ª–∏—á–Ω—ã–µ —Ñ–∏–ª—å–º—ã
   - –ö–Ω–æ–ø–∫–∞ –ª–∞–π–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–∏–¥–Ω–∞ –Ω–∞ –∫–∞–∂–¥–æ–π –∫–∞—Ä—Ç–æ—á–∫–µ

3. **Toggle –ª–∞–π–∫–∞:**
   - –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –ª–∞–π–∫–∞
   - –°—á–µ—Ç—á–∏–∫ –¥–æ–ª–∂–µ–Ω —É–≤–µ–ª–∏—á–∏—Ç—å—Å—è, –∏–∫–æ–Ω–∫–∞ –¥–æ–ª–∂–Ω–∞ —Å—Ç–∞—Ç—å —Å–∏–Ω–µ–π (–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–π)
   - –ù–∞–∂–º–∏—Ç–µ –µ—â–µ —Ä–∞–∑ - –ª–∞–π–∫ –¥–æ–ª–∂–µ–Ω —Å–Ω—è—Ç—å—Å—è, —Å—á–µ—Ç—á–∏–∫ —É–º–µ–Ω—å—à–∏—Ç—å—Å—è

4. **–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å:**
   - –ü–æ—Å—Ç–∞–≤—å—Ç–µ –ª–∞–π–∫ –Ω–∞ —Ñ–∏–ª—å–º
   - –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É
   - –õ–∞–π–∫ –¥–æ–ª–∂–µ–Ω –æ—Å—Ç–∞—Ç—å—Å—è
   - –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –µ—â–µ —Ä–∞–∑ - –Ω–∏—á–µ–≥–æ –Ω–µ –¥–æ–ª–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å—Å—è (toggle —Ä–∞–±–æ—Ç–∞–µ—Ç)

5. **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:**
   - –ù–∞–∂–º–∏—Ç–µ "–ü–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏" - —Ñ–∏–ª—å–º—ã –¥–æ–ª–∂–Ω—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ª–∞–π–∫–æ–≤
   - –ù–∞–∂–º–∏—Ç–µ "–ü–æ –¥–∞—Ç–µ" - —Ñ–∏–ª—å–º—ã –¥–æ–ª–∂–Ω—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø–æ –¥–∞—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è

6. **–ü—Ä–∏–≤–∞—Ç–Ω—ã–µ —Ñ–∏–ª—å–º—ã:**
   - –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ "–ú–æ–∏ —Ñ–∏–ª—å–º—ã" (`/dashboard`) –∫–Ω–æ–ø–∫–∞ –ª–∞–π–∫–∞ –Ω–µ –¥–æ–ª–∂–Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è
   - –¢–æ–ª—å–∫–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ "–ü—É–±–ª–∏—á–Ω—ã–µ —Ñ–∏–ª—å–º—ã" (`/dashboard/public`)

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ API route
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—É–±–ª–∏—á–Ω–æ—Å—Ç–∏ —Ñ–∏–ª—å–º–∞ –ø–µ—Ä–µ–¥ –ª–∞–π–∫–æ–º
- ‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –≤ –ë–î –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

## üìù –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
prisma/schema.prisma          # –ú–æ–¥–µ–ª—å Like
app/api/films/[id]/like/route.ts  # API route –¥–ª—è toggle –ª–∞–π–∫–∞
app/dashboard/public/page.tsx    # –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—É–±–ª–∏—á–Ω—ã—Ö —Ñ–∏–ª—å–º–æ–≤ (–æ–±–Ω–æ–≤–ª–µ–Ω–∞)
components/dashboard/like-button.tsx  # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–Ω–æ–ø–∫–∏ –ª–∞–π–∫–∞
components/dashboard/film-card.tsx    # –ö–∞—Ä—Ç–æ—á–∫–∞ —Ñ–∏–ª—å–º–∞ (–æ–±–Ω–æ–≤–ª–µ–Ω–∞)
components/dashboard/films-list.tsx   # –°–ø–∏—Å–æ–∫ —Ñ–∏–ª—å–º–æ–≤ (–æ–±–Ω–æ–≤–ª–µ–Ω–∞)
```

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏:**
   - –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –±–æ–ª—å—à–µ –∑–∞–ø–∏—Å–µ–π (100 –≤–º–µ—Å—Ç–æ 10)
   - –ó–∞—Ç–µ–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –ø–∞–º—è—Ç–∏
   - –î–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (raw SQL –∑–∞–ø—Ä–æ—Å)

2. **–¢–∏–ø–∏–∑–∞—Ü–∏—è Prisma:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω `as any` –¥–ª—è –æ–±—Ö–æ–¥–∞ –ø—Ä–æ–±–ª–µ–º —Å —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏
   - –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ TypeScript —Å–µ—Ä–≤–µ—Ä–∞ —Ç–∏–ø—ã –¥–æ–ª–∂–Ω—ã –æ–±–Ω–æ–≤–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

- [ ] –î–æ–±–∞–≤–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –ª–∞–π–∫
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ª–∞–π–∫–Ω—É–ª–∏ —Ñ–∏–ª—å–º
- [ ] –î–æ–±–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –ª–∞–π–∫–∞
- [ ] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –ø–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É (—Ç–æ–ø —Ñ–∏–ª—å–º–æ–≤ –ø–æ –ª–∞–π–∫–∞–º)

